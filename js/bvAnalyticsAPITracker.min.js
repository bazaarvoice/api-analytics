var bvAnalyticsVersion="1.4.2";var bvTagDebugging=false;var bvFunctions={};bvDebugLog=function(){if(bvTagDebugging){if(arguments.length>0){arguments[0]="bvAnalytics: "+arguments[0]}console.log.apply(console,arguments)}};bvFunctions.ApiTag=function(a,d){d=!!d;var c="network-stg.bazaarvoice.com";var g="network.bazaarvoice.com";var b=(d?"a.gif":"t.gif");var e=(d?"https://":"//");var f;if(a!="staging"){f=g;bvTagDebugging=false}else{f=c;bvTagDebugging=true}this.host=e+f;this.path="/"+b;this.params={};this.batchParams=[];this.appendParamSeries=function(i){var h=this;bvFunctions.processObject(i,function(j,k){h.appendParam(j,k)});return this};this.appendParam=function(h,i){if(bvFunctions.isDefined(i)){this.params[h]=i}return this};this.toString=function(i){var h=this.host+this.path+"?"+this._assembleQuerySeries(this.params,i);return h};this.execute=function(i){var h=new Image(1,1).src=this.toString(i)};this.maxURILength=function(){return(bvFunctions.isIE()?2036:8192)};this.batch=function(j){var i=this._filterQuerySeries(this.params,j,{});this.batchParams.push(i);if(this.batchParams.length>1){var h=this.host+this.path+"?r_batch="+bvFunctions.encode(this.batchParams);if(h.length>=this.maxURILength()){this.batchParams.pop();this.executeBatch(j);this.batchParams.push(i)}}this.params={}};this.batchSize=function(){return this.batchParams.length};this.executeBatch=function(j){if(this.batchParams.length>1){var h=this.host+this.path+"?r_batch="+bvFunctions.encode(this.batchParams);var i=new Image(1,1).src=h}else{this.params=this.batchParams[0];this.execute(j)}this.batchParams=[]};this._filterQueryItem=function(i,h,j){if(bvFunctions.isDefined(j)){if(bvFunctions.isBoolean(j)){j=j?1:0}if(bvFunctions.isObject(j)){h="r_"+h}if(bvFunctions.isArray(i)){encodedValue=bvFunctions.encode(j);i.push(h+"="+encodedValue)}else{i[h]=j}}};this._filterQuerySeries=function(j,i,h){var o;if(bvFunctions.isUndefined(i)){var q=[];for(o in j){if(Object.prototype.hasOwnProperty.call(j,o)){q.push(o)}}i={required:q,recommended:[],optional:[]}}var l=i.required;var p=i.recommended;var m=i.optional;var n;var k=l.length;for(n=0;n<k;++n){o=l[n];this._filterQueryItem(h,o,j[o])}k=p.length;for(n=0;n<k;++n){o=p[n];this._filterQueryItem(h,o,j[o])}k=m.length;for(n=0;n<k;++n){o=m[n];this._filterQueryItem(h,o,j[o])}return h};this._assembleQuerySeries=function(i,h){var j=this._filterQuerySeries(i,h,[]);return j.join("&")};return this};bvFunctions.parseURI=function(e){var d={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var a=d.parser[d.strictMode?"strict":"loose"].exec(e),c={},b=14;while(b--){c[d.key[b]]=a[b]||""}c[d.q.name]={};c[d.key[12]].replace(d.q.parser,function(g,f,h){if(f){c[d.q.name][f.replace(/r_(.*)/,function(j,i){return i})]=h}});return c};bvFunctions.ApiTag.prototype.validate=function(b){var a=this.toString(b);var e=bvFunctions.parseURI(a).queryKey;var k=true;var d=[];var g=b.required;var l=b.recommended;var h=b.optional;bvDebugLog("Validate %s.%s:",e.cl,(e.type||e.contentType));var i;var j;var f=g.length;for(i=0;i<f;++i){j=g[i];if(e.hasOwnProperty(j)){delete e[j]}else{bvDebugLog("- MISSING required '%s'",j);d.push(j);k=false}}f=l.length;for(i=0;i<f;++i){j=l[i];if(e.hasOwnProperty(j)){delete e[j]}else{bvDebugLog("- Missing recommended '%s'",j)}}f=h.length;for(i=0;i<f;++i){j=h[i];if(e.hasOwnProperty(j)){delete e[j]}}bvFunctions.processObject(e,function(m,n){bvDebugLog("- Extra parameter '%s'",m)});bvDebugLog("- %s",(k?"PASS":"FAIL"));if(!k){var c={cl:"Error",type:this.params.cl+"-"+this.params.type};this.params.cl=c.cl;this.params.type=c.type;this.params.detail1="Missing critical parameters";this.params.detail2=d.join(",")}return this};bvFunctions.ApiTag.prototype.normalizeData=function(e,d){var b="dataLayer";var g={};if(bvFunctions.isUndefined(e)){return g}if(bvFunctions.isDefined(e[b])){e=e[b]}jQuery.extend(g,e);if(g.environment!="staging"){bvTagDebugging=false}else{bvTagDebugging=true}var c=d.length;for(var a=0;a<c;++a){var f=d[a];if(bvFunctions.isUndefined(g[f])){g[f]=e}}return g};bvFunctions.calcImpressionSet=function(d,b){var f=bvFunctions.getGroupSeries("bvAttributes",d,b);var c=bvFunctions.getTagState();if(bvFunctions.isUndefined(c.deBounce)){c.deBounce={}}collection=[];if(bvFunctions.isUndefined(f.impressionContentId)){bvDebugLog("impressionContentId attribute is not defined, can not determine impressions status.");return collection}var e=bvFunctions.getTimeMs();var h=c.deBounce.impression||e;var i=e-h;if((i<1)||(i>f.debouncePeriodMs)){c.deBounce.impression=e;var j=c.impressions||{};var a=bvFunctions.calcImpression(f.impressionClass,f.minVisiblePixels);for(var k=0;k<a.length;++k){var g=a[k];c=bvFunctions.collectComponentData(g,d,b);if(j[c.component.contentId]!=true){j[c.component.contentId]=true;collection.push(g)}}c.impressions=j}return collection};bvFunctions.calcImpression=function(j,g){var c=document.documentElement||document.body;var d=window.innerHeight||c.clientHeight;var h=[];if(bvFunctions.isUndefined(j)){bvDebugLog("BV UGC Container class is not defined, can not determine impressions status.");return h}var a=$("."+j);if(bvFunctions.isUndefined(a)||(a.length<1)){bvDebugLog("Can not find any BV UGC elements of class '%s' to test impressions against",j);return h}for(var i=0;i<a.length;++i){var e=a[i];var f=e.getBoundingClientRect();var b;if(f.top<=0){b=Math.max(f.top+f.height,0);b=Math.min(b,d)}else{if(f.top>=d){b=0}else{b=Math.min(d-f.top,f.height)}}if(b>g){h.push(e)}}return h};bvFunctions.risonEncoding={};bvFunctions.encode=function(a){if(bvFunctions.isString(a)){return bvFunctions.risonEncoding.quote(a)}return bvFunctions.risonEncoding.encode(a)};bvFunctions.escape=function(a){return bvFunctions.risonEncoding.quote(a)};bvFunctions.risonEncoding.uri_ok={"~":true,"!":true,"*":true,"(":true,")":true,"-":true,_:true,".":true,",":true,":":true,"@":false,"$":true,"'":true,"/":true};(function(){var a=[];for(var b=0;b<16;b++){for(var d=0;d<16;d++){if(b+d===0){continue}var e=String.fromCharCode(b*16+d);if(!/\w|[\-_.\/~]/.test(e)){a.push("\\u00"+b.toString(16)+d.toString(16))}}}bvFunctions.risonEncoding.not_idchar=a.join("")})();bvFunctions.risonEncoding.not_idchar=" \t\r\n\"<>\\[\\]{}'!=:(),*@$;&";bvFunctions.risonEncoding.not_idstart="-0123456789";(function(){var a="[^"+bvFunctions.risonEncoding.not_idstart+bvFunctions.risonEncoding.not_idchar+"][^"+bvFunctions.risonEncoding.not_idchar+"]*";bvFunctions.risonEncoding.id_ok=new RegExp("^"+a+"$");bvFunctions.risonEncoding.next_id=new RegExp(a,"g")})();bvFunctions.risonEncoding.quote=function(a){var b=bvFunctions.risonEncoding.uri_ok;if(/^[A-Za-z0-9_\-]*$/.test(a)){return a}a=a.replace(/([^A-Za-z0-9_\-])/g,function(e,d){var f=b[d];if(f){return d}return encodeURIComponent(d)});return a.replace(/%20/g,"+")};(function(){var b={"'":true,"!":true},a={array:function(d){var g=["!("],c,k,j,e=d.length,h;for(j=0;j<e;j+=1){h=d[j];k=a[typeof h];if(k){h=k(h);if(typeof h=="string"){if(c){g[g.length]=","}g[g.length]=h;c=true}}}g[g.length]=")";return g.join("")},"boolean":function(c){if(c){return"!t"}return"!f"},"null":function(c){return"!n"},number:function(c){if(!isFinite(c)){return"!n"}return String(c).replace(/\+/,"")},object:function(d){if(d){if(d instanceof Array){return a.array(d)}if(typeof d.__prototype__==="object"&&typeof d.__prototype__.encode_rison!=="undefined"){return d.encode_rison()}var e=["("],c,j,h,g,k,l=[];for(h in d){l[l.length]=h}l.sort();for(k=0;k<l.length;k++){h=l[k];g=d[h];j=a[typeof g];if(j){g=j(g);if(typeof g=="string"){if(c){e[e.length]=","}e.push(a.string(h),":",g);c=true}}}e[e.length]=")";return e.join("")}return"!n"},string:function(c){if(c===""){return"''"}if(bvFunctions.risonEncoding.id_ok.test(c)){return bvFunctions.risonEncoding.quote(c)}c=c.replace(/(['!])/g,function(e,d){if(b[d]){return"!"+d}return d});return"'"+bvFunctions.risonEncoding.quote(c)+"'"},undefined:function(c){return"!n"}};bvFunctions.risonEncoding.encode=function(c){return a[typeof c](c)}})();bvFunctions.collectFeatureData=function(a){var b=bvFunctions.getTagState();var c;if(bvFunctions.isDefined(a.target)){c=$(a.target)}else{c=$(a)}b.event={name:c.attr("bvName")||c.attr("id")||"",detail1:c.attr("bvDetail1")||"",detail2:c.attr("bvDetail2")||""};b.eventIndex=c.attr("bvEventIndex")||"-1";return b};bvFunctions.collectComponentData=function(d,c,b){var e=bvFunctions.getTagState();var f;if(bvFunctions.isDefined(d.target)){f=$(d.target)}else{f=$(d)}var a=bvFunctions.getGroupSeries("bvAttributes",c,b);e.component={contentId:f.attr(a.impressionContentId)||f.attr("bvContentId")||f.attr("id")||"",contentType:f.attr("bvContentType")||"",parentId:f.attr("bvParentId")||"",parentType:f.attr("bvParentType")||"",numPeers:f.attr("bvNumPeers")||"",peerPosition:f.attr("bvPeerPosition")||""};e.componentIndex=f.attr("bvComponentIndex")||"-1";return e};bvFunctions.getGroupSeries=function(h,f,e){if(bvFunctions.isUndefined(f)){bvDebugLog("getGroupSeries data is undefined, unable to access data bound to '%s'.",h);return{}}if(bvFunctions.isDefined(window._bvData)){var a=jQuery.extend({},_bvData.defaults[h]());var g=_bvData.maps[h](f,e);if(bvFunctions.isDefined(g)){g=g[bvFunctions.isAPIData(f)?"api":"w3c"]}}else{g={};a=f}g=$.extend(g,bvFunctions.getOverrideMap(e,h));if(bvFunctions.isArray(f)){var b=bvFunctions.getState(h+"Index");if(bvFunctions.isString(b)){b=parseInt(b)}if(b>=0){var d=f[b];if(bvFunctions.isUndefined(d)){bvDebugLog("Can not access "+h+"Index in array %O",f);d={}}f=d}}var c={};bvFunctions.processObject(g,function(k,l){var m=l.split(".");var j=f;for(var i=0;i<m.length&&j;++i){j=j[m[i]]}if(bvFunctions.isUndefined(j)){j=f[k]}j=j||a[k];if(bvFunctions.isDefined(j)){c[k]=j}delete a[k]});bvFunctions.processObject(a,function(i,j){c[i]=j});return c};bvFunctions.getOverrideMap=function(c,d){var b=d+"Map";var a;if((bvFunctions.isDefined(c))&&bvFunctions.isObject(c)){a=c[b]||c.map;if(bvFunctions.isUndefined(a)){bvDebugLog("Can not find data map named '%s' or 'map' in %O",b,c);a={}}}return a};bvFunctions.getGroupArraySeries=function(f,e,d){var c=[];if(bvFunctions.isArray(e)){var b=e.length;for(var a=0;a<b;++a){c.push(bvFunctions.getGroupSeries(f,e[a],d))}}else{bvDebugLog("getGroupArraySeries on non-array data %O",e);c.push(bvFunctions.getGroupSeries(f,e,d))}seriesObject={};seriesObject[f]=c;return seriesObject};bvFunctions.getAPIObjectID=function(a){if(bvFunctions.isDefined(a.Includes)){var c=a.Includes.Products;for(var b in c){if(c.hasOwnProperty(b)){return b}}}};bvFunctions.isDefined=function(a){return !bvFunctions.isUndefined(a)};bvFunctions.isUndefined=function(a){return(typeof(a)==="undefined")||(a==null)||((typeof(a)==="string"&&(a.length<1)))};bvFunctions.isArray=function(a){return a instanceof Array};bvFunctions.isBoolean=function(a){return typeof(a)==="boolean"};bvFunctions.isString=function(a){return typeof(a)==="string"};bvFunctions.isNumber=function(a){return typeof(a)==="number"};bvFunctions.isFunction=function(a){return typeof(a)==="function"};bvFunctions.isObject=function(a){return a===Object(a)};bvFunctions.isPublic=function(a){return a[0]!="_"};bvFunctions.isPrivate=function(a){return a[0]=="_"};bvFunctions.isIE=function(){var a=3,c=document.createElement("div"),b=c.getElementsByTagName("i");do{c.innerHTML="<!--[if gt IE "+(++a)+"]><i></i><![endif]-->"}while(b[0]);return a>4?true:false};bvFunctions.markTriggered=function(a){var b=bvFunctions.triggerList||{};bvFunctions.triggerList=b;if(b[a]!=true){b[a]=true}};bvFunctions.isTriggered=function(a){return bvFunctions.triggerList[a]||false};bvFunctions.processObject=function(b,a){for(var c in b){if(b.hasOwnProperty(c)){a(c,b[c])}}};bvFunctions.isAPIData=function(a){return Boolean((a&&(a instanceof Object)&&a.Includes&&a.TotalResults))};bvFunctions.getTagState=function(){var a=$(window).data("bvTagState")||{};$(window).data("bvTagState",a);return a};bvFunctions.getState=function(b){var d=bvFunctions.getTagState();if(bvFunctions.isDefined(b)){var e=b.split(".");var c=d;for(var a=0;a<e.length&&c;++a){c=c[e[a]]}return c}};bvFunctions.calcLoadIDValue=function(){var f=bvFunctions.getTagState();var b=f.loadId;if(bvFunctions.isDefined(b)){return b}else{b=""}var d=16,a=20,e=Math.floor((Math.random()*(a-d+1)+d)),c=0;while(c++<e){b+=(Math.random()*16|0).toString(16)}f.loadId=b;return f.loadId};bvFunctions.getLoadID=function(){return bvFunctions.calcLoadIDValue()};bvFunctions.resetLoadID=function(){var a=bvFunctions.getTagState();a.loadId=null;return bvFunctions.calcLoadIDValue()};bvFunctions.setLoadID=function(a){var b=bvFunctions.getTagState();b.loadId=a;return b.loadId};bvFunctions.cacheBuster=function(){return Math.round(Math.random()*2147483647)};bvFunctions.getTimeMs=function(){return(new Date()).getTime()};bvFunctions.calcTimingValue=function(){var c;var a=window.performance||window.webkitPerformance||window.mozPerformance||window.oPerformance||window.msPerformance||false;var b={};if(a!==false&&(c=a.timing)){b.dns=c.domainLookupEnd-c.domainLookupStart;b.con=c.connectEnd-c.connectStart;b.req=c.responseStart-c.connectEnd;b.res=c.responseEnd-c.responseStart;b.load=c.loadEventStart-c.responseEnd;b.tot=c.loadEventEnd-c.navigationStart}else{return null}return b};bvFunctions.testCookiesEnabled=function(){var a=window.navigator.cookieEnabled?true:false;if((bvFunctions.isUndefined(window.navigator.cookieEnabled))&&!a){document.cookie="testcookie";a=(document.cookie.indexOf("testcookie")!=-1)?true:false}return a};bvFunctions.getDocumentReferrer=function(){if(document.referrer&&(document.referrer.length>0)){return document.referrer}};bvFunctions.getResolution=function(){if(bvFunctions.isUndefined(window.screen)){return"-"}return""+window.screen.width+"x"+window.screen.height};bvFunctions.calcInViewValid=function(c,a){var b=bvFunctions.getGroupSeries("bvAttributes",c,a);var f=bvFunctions.getTagState();if(bvFunctions.isUndefined(f.deBounce)){f.deBounce={}}if(f.inView!=true){var e=bvFunctions.getTimeMs();var g=f.deBounce.inView||e;var d=e-g;if((d<1)||(d>b.debouncePeriodMs)){f.deBounce.inView=e;if(bvFunctions.calcInView(b.containerId,b.minVisiblePixels)){f.inView=true;return true}}}return false};bvFunctions.calcViewedUGCValid=function(c,a){var b=bvFunctions.getGroupSeries("bvAttributes",c,a);var d=bvFunctions.getTagState();if(d.viewedUGC!=true){if(bvFunctions.calcInView(b.containerId,b.minVisiblePixels)){d.viewedUGC=true;return true}else{setTimeout(function(){$(window).trigger("bvViewedUGC")},b.inviewTime)}}return false};bvFunctions.armUsedUGC=function(c,a){var b=bvFunctions.getGroupSeries("bvAttributes",c,a);setTimeout(function(){$(window).trigger("bvViewedUGC")},b.inviewTime)};bvFunctions.chainUsedUGC=function(){$(window).trigger("bvChainViewedUGC")};bvFunctions.calcInView=function(d,f){var g=document.documentElement||document.body;var c=window.innerHeight||g.clientHeight;if(bvFunctions.isUndefined(d)){bvDebugLog("BV UGC Container ID is not defined, can not determine InView status.");return false}var b=document.getElementById(d);if(bvFunctions.isUndefined(b)){bvDebugLog("Can not find BV UGC Container '%s' to test InView against",d);return false}if($(b).css("visibility").toLowerCase()=="hidden"){return false}var a=b.getBoundingClientRect();var e;if(a.top<=0){e=Math.max(a.top+a.height,0);e=Math.min(e,c)}else{if(a.top>=c){e=0}else{e=Math.min(c-a.top,a.height)}}return(e>f)};var _bvData={tagValidators:{Conversion:{optional:["charset","cookies","geo","host","res","detail1","detail2","_"],recommended:["environment","dc","lang","ref","city","state","country","label"],required:["cl","type","client","bvProduct","source","loadId","tz","apiJSVersion","value"]},ConversionTransaction:{optional:["charset","cookies","geo","host","res","tax","shipping","name","sku","price","quantity","imageUrl","category","detail1","detail2","_"],recommended:["environment","dc","lang","ref","city","state","country","currency"],required:["cl","type","client","bvProduct","source","loadId","tz","apiJSVersion","orderId","total","items"]},FeatureUsed:{optional:["charset","cookies","geo","host","res","rootCategoryId","_"],recommended:["environment","dc","lang","ref","productId","brand","categoryId","detail1","detail2"],required:["cl","type","client","interaction","bvProduct","source","loadId","tz","apiJSVersion","name"]},FeatureUsedInView:{optional:["charset","cookies","geo","host","res","rootCategoryId","detail1","detail2","_"],recommended:["environment","dc","lang","ref","productId","brand","categoryId"],required:["cl","type","client","name","interaction","bvProduct","source","loadId","tz","apiJSVersion"]},FeatureUsedViewedUGC:{optional:["charset","cookies","geo","host","res","rootCategoryId","detail1","detail2","_"],recommended:["environment","dc","lang","ref","productId","brand","categoryId"],required:["cl","type","client","name","interaction","bvProduct","source","loadId","tz","apiJSVersion"]},Impression:{optional:["charset","cookies","geo","host","res","rootCategoryId","numPeers","peerPosition","parentId","parentType","type","detail1","detail2","_"],recommended:["environment","dc","lang","ref","productId","brand","categoryId"],required:["cl","client","bvProduct","source","loadId","tz","apiJSVersion","contentId","contentType"]},PIIConversion:{optional:["charset","cookies","geo","host","res","orderId","detail1","detail2","_"],recommended:["environment","dc","lang","ref","city","state","zip","country","label","userId","nickname","deliveryDate"],required:["cl","type","client","bvProduct","source","loadId","tz","apiJSVersion","email","value"]},PIIConversionTransaction:{optional:["charset","cookies","geo","host","res","tax","shipping","deliveryDate","name","sku","price","quantity","imageUrl","category","detail1","detail2","_"],recommended:["environment","dc","lang","ref","city","state","zip","country","userId","nickname","currency"],required:["cl","type","client","bvProduct","source","loadId","tz","apiJSVersion","orderId","total","email","items"]},PageViewCategory:{optional:["charset","cookies","geo","host","res","detail1","detail2","t","_"],recommended:["environment","dc","lang","ref","rootCategoryId"],required:["cl","type","client","bvProduct","source","loadId","tz","apiJSVersion","categoryId"]},PageViewProduct:{optional:["charset","cookies","geo","host","res","rootCategoryId","numAnswers","numQuestions","percentRecommended","detail1","detail2","t","_"],recommended:["environment","dc","lang","ref","brand","categoryId","numReviews","avgRating"],required:["cl","type","client","bvProduct","source","loadId","tz","apiJSVersion","productId"]}},defaults:{event:function(a,b){return{detail1:bvFunctions.getState("event.detail1"),detail2:bvFunctions.getState("event.detail2"),name:bvFunctions.getState("event.name")}},product:function(a,b){return{}},transaction:function(a,b){return{}},items:function(a,b){return{}},component:function(a,b){return{contentId:bvFunctions.getState("component.contentId"),contentType:bvFunctions.getState("component.contentType"),numPeers:bvFunctions.getState("component.numPeers"),parentId:bvFunctions.getState("component.parentId"),parentType:bvFunctions.getState("component.parentType"),peerPosition:bvFunctions.getState("component.peerPosition")}},conversion:function(a,b){return{}},bvAttributes:function(a,b){return{debouncePeriodMs:250,inviewTime:5000,minVisiblePixels:100}},page:function(a,b){return{apiJSVersion:bvAnalyticsVersion,bvProduct:"analyticsAPI",charset:document.charset,cookies:bvFunctions.testCookiesEnabled(),dc:window.navigator.language,geo:("geolocation" in window.navigator),host:window.location.hostname,lang:window.navigator.language,loadId:bvFunctions.calcLoadIDValue(),ref:bvFunctions.getDocumentReferrer(),res:bvFunctions.getResolution(),source:"analyticsAPI",t:bvFunctions.calcTimingValue(),tz:(new Date()).getTimezoneOffset()}}},maps:{event:function(a,b){return{api:{},w3c:{detail1:"category.subDetail1",detail2:"category.subDetail2",name:"name"}}},product:function(a,b){return{api:{avgRating:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".ReviewStatistics.AverageOverallRating",brand:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".Brand.Id",categoryId:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".CategoryId",notRecommended:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".ReviewStatistics.NotRecommendedCount",numAnswers:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".QAStatistics.TotalAnswerCount",numQuestions:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".QAStatistics.TotalQuestionCount",numReviews:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".TotalResults",percentRecommended:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".ReviewStatistics.percentRecommended",productId:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".Id",recommended:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".ReviewStatistics.RecommendedCount",rootCategoryId:"Includes.Products."+bvFunctions.getAPIObjectID(a)+".RootCategoryId"},w3c:{avgRating:"attributes.ugc.averageRating",brand:"productInfo.brandID",categoryId:"category.primaryCategory",notRecommended:"attributes.ugc.notRecommended",numAnswers:"attributes.ugc.numAnswers",numQuestions:"attributes.ugc.numQuestions",numReviews:"attributes.ugc.numReviews",percentRecommended:"attributes.ugc.percentRecommended",productId:"productInfo.productID",recommended:"attributes.ugc.recommended",rootCategoryId:"category.rootCategory"}}},transaction:function(a,b){return{api:{},w3c:{city:"profile.address.city",country:"profile.address.country",currency:"total.currency",deliveryDate:"total.deliveryDate",email:"profile.profileInfo.email",nickname:"profile.profileInfo.userName",orderId:"transactionID",shipping:"total.shipping",state:"profile.address.state",tax:"total.taxAmount",total:"total.transactionTotal",userId:"profile.profileInfo.profileID",zip:"profile.address.postalCode"}}},_tag:function(a,b){return{api:{client:"clientID",environment:"environment"},w3c:{client:"clientID",environment:"environment"}}},items:function(a,b){return{api:{},w3c:{category:"category.primaryCategory",imageUrl:"productInfo.productImage",name:"productInfo.productName",price:"price.basePrice",quantity:"quantity",sku:"productInfo.sku"}}},component:function(a,b){return{api:{},w3c:{contentId:"componentInfo.componentID",contentType:"category.primaryCategory",numPeers:"attributes.context.numPeers",parentId:"componentInfo.parentID",parentType:"componentInfo.parentType",peerPosition:"attributes.context.peerPosition"}}},conversion:function(a,b){return{api:{},w3c:{city:"profile.address.city",country:"profile.address.country",deliveryDate:"attributes.deliveryDate",email:"profile.profileInfo.email",label:"attributes.label",nickname:"profile.profileInfo.userName",orderId:"transactionID",state:"profile.address.state",type:"category.type",userId:"profile.profileInfo.profileID",value:"attributes.value",zip:"profile.address.postalCode"}}},bvAttributes:function(a,b){return{api:{containerId:"containerId",debouncePeriodMs:"debouncePeriodMs",impressionClass:"impressionClass",impressionContentId:"impressionContentId",inviewTime:"inviewTime",minVisiblePixels:"minVisiblePixels"},w3c:{containerId:"containerId",debouncePeriodMs:"debouncePeriodMs",impressionClass:"impressionClass",impressionContentId:"impressionContentId",inviewTime:"inviewTime",minVisiblePixels:"minVisiblePixels"}}},page:function(a,b){return{api:{},w3c:{apiJSVersion:"pageInfo.apiJSVersion",bvProduct:"pageInfo.bvProduct",charset:"pageInfo.charset",cookies:"pageInfo.cookiesEnabled",dc:"pageInfo.region",geo:"pageInfo.geoLocationEnabled",host:"pageInfo.hostName",lang:"pageInfo.language",loadId:"pageInfo.loadID",ref:"pageInfo.referringURL",res:"pageInfo.resolution",source:"pageInfo.source",t:"pageInfo.t",tz:"pageInfo.timeZone"}}}},tagGroupings:{Conversion:["_tag","conversion","page"],ConversionTransaction:["page","transaction","items","_tag"],FeatureUsed:["_tag","page","event","product"],FeatureUsedInView:["page","product","_tag"],FeatureUsedViewedUGC:["page","product","_tag"],Impression:["page","product","component","_tag"],PIIConversion:["_tag","conversion","page"],PIIConversionTransaction:["page","transaction","items","_tag"],PageViewCategory:["_tag","page","product"],PageViewProduct:["_tag","page","product"],_all:["page","product","component","_tag","bvAttributes","conversion","transaction","items","event"]}};bvFunctions.ApiTracker=function(){delete bvFunctions.ApiTracker.dataLayer;this.push=function(){try{var b;var c=arguments.length;for(var a=0;a<c;++a){b=arguments[a];if(bvFunctions.isArray(b)){if(b.length!=2){bvDebugLog("Analytics requests require exactly two parameters:  %O",b);continue}var d=b[0];var g=b[1];if(!bvFunctions.isString(d)){bvDebugLog("Analytics tag names must be strings: %O",d);continue}if(bvFunctions.isPrivate(d)){continue}if(bvFunctions.isUndefined(this[d])){bvDebugLog("Unrecognized tag name: %s",d);continue}if(bvFunctions.isObject(g)&&bvFunctions.isUndefined(bvFunctions.ApiTracker.dataLayer)){bvFunctions.ApiTracker.dataLayer=g;bvDebugLog("Implicitly binding data layer: %O",g)}this[d](g)}else{bvDebugLog("Analytics request is not in the form of an array: %O",b)}}}catch(f){if(bvTagDebugging){throw f}}return 1};this.BindDataLayer=function(a){bvFunctions.ApiTracker.dataLayer=a;bvDebugLog("Explicitly binding data layer: %O",a)};this.SetDebugging=function(a){bvTagDebugging=a};this.NoOp=function(a){};this._NoOp=function(a){};this.BindTagEvents=function(e){var b=e.length;for(var a=0;a<b;++a){var d=e[a];if(!bvFunctions.isString(d)){bvDebugLog("Analytics tag names must be strings: %O",d);continue}if(bvFunctions.isPrivate(d)){continue}var c="bind"+d;if(bvFunctions.isUndefined(this[c])){bvDebugLog("Don't know how to bind events for: %s",d);continue}this[c]()}};this.execute=function(a){if(bvFunctions.isFunction(a)){a()}}};bvFunctions.ApiTracker.prototype.Conversion=function(b){bvDebugLog("ApiTracker.Conversion --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.Conversion);var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({cl:"Conversion",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("conversion",c.conversion,c.conversionMap)).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.Conversion);a.execute(_bvData.tagValidators.Conversion);bvFunctions.markTriggered("Conversion")};bvFunctions.ApiTracker.prototype.bindConversion=function(){$(".bvConversion").on("click",function(a){bvFunctions.ApiTracker.prototype.Conversion(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.PIIConversion=function(b){bvDebugLog("ApiTracker.PIIConversion --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.PIIConversion);var a=new bvFunctions.ApiTag(c.environment,true).appendParamSeries({cl:"PIIConversion",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("conversion",c.conversion,c.conversionMap)).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.PIIConversion);a.execute(_bvData.tagValidators.PIIConversion);bvFunctions.markTriggered("PIIConversion")};bvFunctions.ApiTracker.prototype.bindPIIConversion=function(){$(".bvConversion").on("click",function(a){bvFunctions.ApiTracker.prototype.PIIConversion(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.ConversionTransaction=function(b){bvDebugLog("ApiTracker.ConversionTransaction --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.ConversionTransaction);var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({type:"Transaction",cl:"Conversion",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("transaction",c.transaction,c.transactionMap)).appendParamSeries(bvFunctions.getGroupArraySeries("items",c.items,c.itemsMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.ConversionTransaction);a.execute(_bvData.tagValidators.ConversionTransaction);bvFunctions.markTriggered("ConversionTransaction")};bvFunctions.ApiTracker.prototype.bindConversionTransaction=function(){$(".bvTransaction").on("click",function(a){bvFunctions.ApiTracker.prototype.ConversionTransaction(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.PIIConversionTransaction=function(b){bvDebugLog("ApiTracker.PIIConversionTransaction --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.PIIConversionTransaction);var a=new bvFunctions.ApiTag(c.environment,true).appendParamSeries({type:"Transaction",cl:"PIIConversion",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("transaction",c.transaction,c.transactionMap)).appendParamSeries(bvFunctions.getGroupArraySeries("items",c.items,c.itemsMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.PIIConversionTransaction);a.execute(_bvData.tagValidators.PIIConversionTransaction);bvFunctions.markTriggered("PIIConversionTransaction")};bvFunctions.ApiTracker.prototype.bindPIIConversionTransaction=function(){$(".bvTransaction").on("click",function(a){bvFunctions.ApiTracker.prototype.PIIConversionTransaction(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.FeatureUsed=function(b){bvDebugLog("ApiTracker.FeatureUsed --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.FeatureUsed);var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({interaction:"1",type:"Used",cl:"Feature",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("event",c.event,c.eventMap)).appendParamSeries(bvFunctions.getGroupSeries("product",c.product,c.productMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.FeatureUsed);a.execute(_bvData.tagValidators.FeatureUsed);bvFunctions.markTriggered("FeatureUsed")};bvFunctions.ApiTracker.prototype.bindFeatureUsed=function(){$(".bvFeature").on("click",function(a){bvFunctions.collectFeatureData(a);bvFunctions.ApiTracker.prototype.FeatureUsed(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.FeatureUsedInView=function(b){var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.FeatureUsedInView);if(bvFunctions.calcInViewValid(c.bvAttributes,c.bvAttributesMap)){bvDebugLog("ApiTracker.FeatureUsedInView --");var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({interaction:"0",type:"Used",name:"InView",cl:"Feature",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("product",c.product,c.productMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.FeatureUsedInView);a.execute(_bvData.tagValidators.FeatureUsedInView);bvFunctions.markTriggered("FeatureUsedInView");bvFunctions.armUsedUGC(c.bvAttributes,c.bvAttributesMap)}};bvFunctions.ApiTracker.prototype.bindFeatureUsedInView=function(){$(window).on("load ready resize scroll",function(a){bvFunctions.ApiTracker.prototype.FeatureUsedInView(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.FeatureUsedViewedUGC=function(b){var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.FeatureUsedViewedUGC);if(bvFunctions.calcViewedUGCValid(c.bvAttributes,c.bvAttributesMap)){bvDebugLog("ApiTracker.FeatureUsedViewedUGC --");var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({interaction:"1",type:"Used",name:"ViewedUGC",cl:"Feature",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("product",c.product,c.productMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.FeatureUsedViewedUGC);a.execute(_bvData.tagValidators.FeatureUsedViewedUGC);bvFunctions.markTriggered("FeatureUsedViewedUGC");bvFunctions.chainUsedUGC()}};bvFunctions.ApiTracker.prototype.bindFeatureUsedViewedUGC=function(){$(window).on("bvViewedUGC",function(a){bvFunctions.ApiTracker.prototype.FeatureUsedViewedUGC(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.Impression=function(d){var f=bvFunctions.ApiTag.prototype.normalizeData(d,_bvData.tagGroupings.Impression);var b=new bvFunctions.ApiTag(f.environment,false);var e=bvFunctions.calcImpressionSet(f.bvAttributes,f.bvAttributesMap);for(var a=0;a<e.length;++a){var c=e[a];bvFunctions.collectComponentData(c,f.bvAttributes,f.bvAttributesMap);bvDebugLog("ApiTracker.Impression --");b.appendParamSeries({cl:"Impression",environment:f.environment,client:f.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",f.page,f.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("product",f.product,f.productMap)).appendParamSeries(bvFunctions.getGroupSeries("component",f.component,f.componentMap)).appendParam("_",bvFunctions.cacheBuster());b.validate(_bvData.tagValidators.Impression);b.batch(_bvData.tagValidators.Impression)}if(b.batchSize()>0){b.executeBatch(_bvData.tagValidators.Impression);bvFunctions.markTriggered("Impression")}};bvFunctions.ApiTracker.prototype.bindImpression=function(){$(window).on("load ready resize scroll",function(a){bvFunctions.ApiTracker.prototype.Impression(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.PageViewCategory=function(b){bvDebugLog("ApiTracker.PageViewCategory --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.PageViewCategory);var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({type:"Category",cl:"PageView",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("product",c.product,c.productMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.PageViewCategory);a.execute(_bvData.tagValidators.PageViewCategory);bvFunctions.markTriggered("PageViewCategory")};bvFunctions.ApiTracker.prototype.bindPageViewCategory=function(){$(window).on("load",function(a){bvFunctions.ApiTracker.prototype.PageViewCategory(bvFunctions.ApiTracker.dataLayer)})};bvFunctions.ApiTracker.prototype.PageViewProduct=function(b){bvDebugLog("ApiTracker.PageViewProduct --");var c=bvFunctions.ApiTag.prototype.normalizeData(b,_bvData.tagGroupings.PageViewProduct);var a=new bvFunctions.ApiTag(c.environment,false).appendParamSeries({type:"Product",cl:"PageView",environment:c.environment,client:c.clientID}).appendParamSeries(bvFunctions.getGroupSeries("page",c.page,c.pageMap)).appendParamSeries(bvFunctions.getGroupSeries("product",c.product,c.productMap)).appendParam("_",bvFunctions.cacheBuster());a.validate(_bvData.tagValidators.PageViewProduct);a.execute(_bvData.tagValidators.PageViewProduct);bvFunctions.markTriggered("PageViewProduct")};bvFunctions.ApiTracker.prototype.bindPageViewProduct=function(){$(window).on("load",function(a){bvFunctions.ApiTracker.prototype.PageViewProduct(bvFunctions.ApiTracker.dataLayer)})};window._bvapiq=window._bvapiq||[];window._bvapi=window._bvapi||new bvFunctions.ApiTracker();if(window._bvapiq.length>0){window._bvapi.push.apply(window._bvapi,window._bvapiq)}window._bvapiq=window._bvapi;
